# Tessera (MambaGo) Phase III è¨­è¨ˆä»•æ§˜æ›¸

**Version:** 1.1.0
**Date:** 2026-01-19
**Status:** Phase III.2 é€²è¡Œä¸­ï¼ˆãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
**Author:** beachcities + Claude + Gemini + Copilot

---

## 0. Phase III ç›®æ¨™

Phase II ã§ç¢ºç«‹ã—ãŸ GPU-Native è‡ªå·±å¯¾æˆ¦å­¦ç¿’åŸºç›¤ã®ä¸Šã«ã€ä»¥ä¸‹ã‚’å®Ÿç¾ã™ã‚‹ï¼š

| # | ç›®æ¨™ | çŠ¶æ…‹ | é”æˆæ–¹æ³• |
|---|------|------|----------|
| 1 | é«˜é€Ÿãªå¯¾å±€ã‚¨ãƒ³ã‚¸ãƒ³ | âœ… å®Œäº† | Tromp-Taylor ãƒ«ãƒ¼ãƒ«æ¡ç”¨ |
| 2 | å‹æ•—äºˆæ¸¬èƒ½åŠ› | ğŸ”„ æ¤œè¨¼ä¸­ | Value Head è¿½åŠ ï¼ˆå®Ÿè£…æ¸ˆã¿ã€åŠ¹æœæ¤œè¨¼ä¸­ï¼‰ |
| 3 | çµ‚å±€æ™‚ã®åœ°è¨ˆç®— | âœ… å®Œäº† | GPU flood-fill (chain_utils.py) |
| 4 | å†…éƒ¨è©•ä¾¡ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | ğŸ”„ é€²è¡Œä¸­ | vs Random, vs Phase II |
| 5 | å¤–éƒ¨è©•ä¾¡ã®æº–å‚™ | â³ æœªç€æ‰‹ | GTP ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ |

---

## 0.1 è¨­è¨ˆåŸå‰‡ï¼ˆPhase II ã‹ã‚‰ç¶™æ‰¿ï¼‰

| åŸå‰‡ | èª¬æ˜ |
|------|------|
| **GPU Complete** | å…¨æ“ä½œãŒ GPU å†…ã§å®Œçµã€CPU è»¢é€ã‚¼ãƒ­ |
| **Vectorized** | Pythonãƒ«ãƒ¼ãƒ—ã‚’æ’é™¤ã—ã€å…¨æ“ä½œã‚’ãƒ†ãƒ³ã‚½ãƒ«æ¼”ç®—ã«ç½®ãæ›ãˆ |
| **Batched** | è¤‡æ•°ã‚²ãƒ¼ãƒ ã‚’ä¸€æ‹¬ã§GPUã«æŠ•å…¥ã—åŒæ™‚å‡¦ç† |
| **Clean Room** | å¤–éƒ¨æ£‹è­œã‚’ä½¿ç”¨ã—ãªã„ï¼ˆè‡ªå·±å¯¾æˆ¦ã®ã¿ï¼‰ |
| **Observable** | å…¨ã¦ã®æŒ™å‹•ãŒãƒ¢ãƒ‹ã‚¿ãƒ¼å¯èƒ½ |

---

## 0.2 ãƒˆãƒ¼ã‚¯ãƒ³è¨­è¨ˆ

| ID | æ„å‘³ | å‚™è€ƒ |
|----|------|------|
| 0-360 | ç›¤ä¸Šåº§æ¨™ (19Ã—19) | |
| 361 | PASS | |
| 362 | PAD | ç€æ‰‹ä¸å¯ã€å­¦ç¿’æ™‚ã®ã¿ä½¿ç”¨ |
| 363 | EOS | äºˆç´„æ¸ˆã¿ã€**æœªä½¿ç”¨** |

**vocab_size = 363**ï¼ˆå­¦ç¿’æ™‚ã®Embedding/Outputæ¬¡å…ƒï¼‰
**PolicyHeadå‡ºåŠ› = 362**ï¼ˆæ¨è«–æ™‚ã€PADã‚’é™¤å¤–ã—ãŸç€æ‰‹å¯èƒ½ç©ºé–“ï¼‰

---

## 1. è¨­è¨ˆæ–¹é‡ã®å¤‰æ›´å±¥æ­´

### 1.1 Phase III å½“åˆè¨ˆç”» vs å®Ÿéš›ã®å®Ÿè£…

Phase III ã®å½“åˆè¨ˆç”»ã§ã¯ã€Œé€£ã® GPU å®Ÿè£…ã€ã‚’ä¸­å¿ƒã«æ®ãˆã¦ã„ãŸã€‚ã—ã‹ã—ã€å®Ÿè£…ã‚’é€²ã‚ã‚‹ä¸­ã§**ã‚ˆã‚Šå„ªã‚ŒãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**ãŒè¦‹ãˆã¦ããŸãŸã‚ã€å¤§ããªæ–¹é‡è»¢æ›ã‚’è¡Œã£ãŸã€‚

| å½“åˆè¨ˆç”» | å®Ÿéš›ã®å®Ÿè£… | å¤‰æ›´ç†ç”± |
|----------|------------|----------|
| é€£ã® GPU å®Ÿè£…ï¼ˆUnion-Find ç­‰ï¼‰ | **Tromp-Taylor ã§æ•ç²å»ƒæ­¢** | æ•ç²ãƒ­ã‚¸ãƒƒã‚¯ä¸è¦åŒ–ã«ã‚ˆã‚Š 100 å€é«˜é€ŸåŒ– |
| ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚³ã‚¦å¯¾å¿œ | è¦‹é€ã‚Š | Tromp-Taylor ã§ã¯é‡è¦åº¦ä½ |
| è‡ªæ®ºæ‰‹åˆ¤å®šã®å®Œå…¨åŒ– | è¦‹é€ã‚Š | Tromp-Taylor ã§ã¯ç©ºç‚¹ç€æ‰‹ã®ã¿ |
| ï¼ˆè¨ˆç”»ãªã—ï¼‰ | **Value Head è¿½åŠ ** | å‹æ•—ä¿¡å·ã«ã‚ˆã‚Šå­¦ç¿’ã®è³ªãŒåŠ‡çš„å‘ä¸Š |
| å°†æ¥æ¤œè¨äº‹é … | **Tesseract Field å®Ÿè£…** | ç©ºé–“-æ™‚é–“èåˆã‚’å‰å€’ã—å®Ÿè£… |

### 1.2 å¤‰æ›´ã®å“²å­¦çš„èƒŒæ™¯

ã“ã®å¤‰æ›´ã¯ã€Œå¦¥å”ã€ã§ã¯ãªãã€Œæœ€é©åŒ–ã€ã§ã‚ã‚‹ã€‚

> **ã€Œãƒ«ãƒ¼ãƒ«ã«å¾“ã† AIã€ã‹ã‚‰ã€Œç©ºé–“ã‚’æ”¯é…ã™ã‚‹çŸ¥èƒ½ã€ã¸ã®è»¢æ›**

è¤‡é›‘ãªé€£ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†ï¼ˆæ•ç²ãƒ»ã‚³ã‚¦ï¼‰ã‚’åˆ‡ã‚Šé›¢ã—ã€ã€Œç›¤é¢ã¨ã„ã†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å æœ‰ç‡ã€ã«ç„¦ç‚¹ã‚’å½“ã¦ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šï¼š

- GPU sovereigntyï¼ˆGPU å®Œçµæ€§ï¼‰ã®æœ€å¤§åŒ–
- å®Ÿè£…ã®ç°¡æ½”åŒ–ã¨ãƒã‚°å‰Šæ¸›
- å­¦ç¿’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®é«˜é€ŸåŒ–
- Mamba ã® SSM ç‰¹æ€§ã¨ã®è¦ªå’Œæ€§å‘ä¸Š

### 1.3 Phase III.2 ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆ2026-01-19ï¼‰

Phase III.2 ã§ Loss 3.58 ã‚’é”æˆã—ã€Œå®Œäº†ã€ã¨åˆ¤æ–­ã—ãŸãŒã€ä»¥ä¸‹ã®å•é¡ŒãŒç™ºè¦šï¼š

- **Win Rate 0%**: vs Random ã§å…¨æ•—
- **ãƒ‘ã‚¹é€£æ‰“**: ã‚²ãƒ¼ãƒ ãŒå³çµ‚äº†ã—ã€ç›¤é¢ã‚’å­¦ç¿’ã—ã¦ã„ãªã„ç–‘ã„

ã“ã‚Œã‚’å—ã‘ã€Phase III.2 ã‚’ã€Œé€²è¡Œä¸­ã€ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€‚Fixedç‰ˆã§å†åº¦ç›¸è»¢ç§»ã‚’ç›®æŒ‡ã™ã€‚

**æ•™è¨“:** **Loss ã®ä½ä¸‹ã‚’ç„¡æ‰¹åˆ¤ã«å–œã°ãªã„ã€‚Win Rate ã§æ¤œè¨¼å¿…é ˆã€‚**

---

## 2. Tromp-Taylor ãƒ«ãƒ¼ãƒ«ã®æ¡ç”¨

### 2.1 æ¡ç”¨ç†ç”±

| ç†ç”± | èª¬æ˜ |
|------|------|
| **GPU Sovereignty** | é€£æ¤œå‡ºãƒ»æ•ç²ã® Python ãƒ«ãƒ¼ãƒ—ã‚’å®Œå…¨æ’é™¤ |
| **é€Ÿåº¦** | 3.1 g/s â†’ 15.6 g/sï¼ˆ5 å€å‘ä¸Šï¼‰ |
| **ç°¡æ½”æ€§** | ç€æ‰‹ = ç©ºç‚¹ã«çŸ³ã‚’ç½®ãã ã‘ |
| **çµ‚å±€ã®æ˜ç¢ºã•** | Area Scoring ã§ä¸€æ„ã«å‹æ•—æ±ºå®š |

### 2.2 Information Continuityï¼ˆæƒ…å ±ã®é€£ç¶šæ€§ï¼‰

Tromp-Taylor ã®å‰¯æ¬¡çš„ãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦ã€**çŸ³ãŒç›¤ä¸Šã‹ã‚‰æ¶ˆãˆãªã„**ã“ã¨ãŒã‚ã‚‹ã€‚

å¾“æ¥ã®æ•ç²ã‚ã‚Šãƒ«ãƒ¼ãƒ«ã§ã¯ï¼š
- çŸ³ãŒæ¶ˆãˆã‚‹ = ç›¤é¢çŠ¶æ…‹ã®ä¸é€£ç¶šãªå¤‰åŒ–
- Mamba ã® SSM State ãŒã€Œæƒ…å ±æå¤±ã€ã‚’çµŒé¨“
- å‹¾é…ã®æµã‚ŒãŒä¸å®‰å®šåŒ–

Tromp-Taylor ã§ã¯ï¼š
- çŸ³ã¯å¸¸ã«ç›¤ä¸Šã«æ®‹ã‚‹
- SSM State ã«ä¸€è²«ã—ãŸæ–‡è„ˆï¼ˆContextï¼‰ã‚’æä¾›
- å‹¾é…ãŒå®‰å®šã—ã€å­¦ç¿’ãŒåæŸã—ã‚„ã™ã„

ã“ã‚Œã‚’ **Information Continuity** ã¨å‘¼ã¶ã€‚Mamba ã® State Space Model ã«ã¨ã£ã¦ã€ã“ã®é€£ç¶šæ€§ã¯å­¦ç¿’åŠ¹ç‡ã«å¤§ããå¯„ä¸ã™ã‚‹ã€‚

### 2.3 Tromp-Taylor ãƒ«ãƒ¼ãƒ«ã®è©³ç´°
```
1. ç›¤é¢: 19Ã—19 ã®æ ¼å­ç‚¹
2. ç€æ‰‹: ç©ºç‚¹ã«è‡ªè‰²ã®çŸ³ã‚’ç½®ãï¼ˆãƒ‘ã‚¹ã‚‚å¯ï¼‰
3. æ•ç²: ãªã—ï¼ˆçŸ³ã¯ç›¤ä¸Šã«æ®‹ã‚‹ï¼‰
4. çµ‚å±€: ä¸¡è€…é€£ç¶šãƒ‘ã‚¹
5. å‹æ•—: Area Scoringï¼ˆçŸ³ + åœ°ï¼‰ã€ã‚³ãƒŸ 6.5
```

---

## 3. TesseraModel ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 3.1 å…¨ä½“æ§‹é€ 
```
TesseraModel
â”œâ”€â”€ MoveEncoder (Embedding + Mamba)
â”‚   â””â”€â”€ æ‰‹é †ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ â†’ æ½œåœ¨è¡¨ç¾
â”œâ”€â”€ TesseractField (Conv2d)
â”‚   â””â”€â”€ ç›¤é¢ 19Ã—19 â†’ ç©ºé–“ç‰¹å¾´
â”œâ”€â”€ Fusion (Linear)
â”‚   â””â”€â”€ ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ç‰¹å¾´ + ç©ºé–“ç‰¹å¾´ â†’ çµ±åˆè¡¨ç¾
â”œâ”€â”€ PolicyHead (Linear)
â”‚   â””â”€â”€ â†’ 362 æ¬¡å…ƒï¼ˆç€æ‰‹ç¢ºç‡ã€PADé™¤å¤–ï¼‰
â””â”€â”€ ValueHead (MLP)
    â””â”€â”€ â†’ 1 æ¬¡å…ƒï¼ˆå‹æ•—äºˆæ¸¬ [-1, +1]ï¼‰
```

**æ¬¡å…ƒã®æ•´ç†:**
- Embeddingå…¥åŠ›: vocab_size = 363
- PolicyHeadå‡ºåŠ›: 362ï¼ˆç›¤ä¸Š361 + PASSã€PADã¯ç€æ‰‹ä¸å¯ãªã®ã§é™¤å¤–ï¼‰

### 3.2 Value Head

Phase III ã§æ–°è¦è¿½åŠ ã€‚å‹æ•—äºˆæ¸¬ã‚’è¡Œã†ã€‚
```python
self.value_head = nn.Sequential(
    nn.Linear(d_model, d_model // 2),
    nn.ReLU(),
    nn.Linear(d_model // 2, 1),
    nn.Tanh()  # å‡ºåŠ›: [-1, +1]
)
```

**æ„ç¾©:**
- Policy ã ã‘ã§ã¯ã€Œæ¬¡ã®æ‰‹ã€ã‚’äºˆæ¸¬ã™ã‚‹ã®ã¿
- Value ã«ã‚ˆã‚Šã€Œã“ã®å±€é¢ã¯å‹ã¡ã‹è² ã‘ã‹ã€ã‚’å­¦ç¿’
- å­¦ç¿’ã«ã€Œç›®çš„ï¼ˆå‹åˆ©ï¼‰ã€ãŒç”Ÿã¾ã‚Œã€åæŸãŒåŠ‡çš„ã«æ”¹å–„

**å®Ÿç¸¾ï¼ˆæˆåŠŸç‰ˆï¼‰:**
- Value Loss: 0.32 â†’ 0.06ï¼ˆ81% å‰Šæ¸›ï¼‰
- Policy Loss: 5.94 â†’ 3.58ï¼ˆ40% å‰Šæ¸›ï¼‰

> âš ï¸ **æ³¨æ„**: ä¸Šè¨˜ã¯ã€ŒæˆåŠŸç‰ˆã€ã®æ•°å€¤ã ãŒã€Win Rate 0% ã§ã‚ã‚Šã€Œãƒ‘ã‚¹é€£æ‰“ã«ã‚ˆã‚‹å½æˆåŠŸã€ã®ç–‘ã„ãŒã‚ã‚‹ã€‚Fixedç‰ˆã§å†æ¤œè¨¼ä¸­ã€‚

### 3.3 Tesseract Field ã®ç†è«–çš„ä½ç½®ã¥ã‘

å½“åˆã® Phase III è¨­è¨ˆæ›¸ã§ã¯ã€Œ19^4 ç©ºé–“ãƒªãƒ³ã‚¯ã€ã‚’å°†æ¥æ¤œè¨äº‹é …ã¨ã—ã¦ã„ãŸã€‚

**å½“åˆã®æ§‹æƒ³:**
- ç‰©ç†çš„ãª 19Ã—19Ã—19Ã—19 ãƒ†ãƒ³ã‚½ãƒ«
- ç›¤é¢ã®å…¨ 361 åœ°ç‚¹ã‹ã‚‰åˆ¥ã®å…¨ 361 åœ°ç‚¹ã¸ã®å½±éŸ¿åŠ›ãƒªãƒ³ã‚¯

**ç¾åœ¨ã®è§£é‡ˆ:**
- ç‰©ç†çš„ãª 19^4 ãƒ†ãƒ³ã‚½ãƒ«ã¯å®Ÿè£…ã—ã¦ã„ãªã„
- ã—ã‹ã—ã€**Mamba ã® SSM State ãŒç›¤é¢ä¸Šã®å…¨åœ°ç‚¹é–“ã®æ½œåœ¨çš„ãªç›¸é–¢ã‚’å‹•çš„ã«ä¿æŒã—ã¦ã„ã‚‹**
- TesseractField (Conv2d) ã¯ç©ºé–“ç‰¹å¾´ã‚’æŠ½å‡ºã—ã€Mamba ã®æ™‚ç³»åˆ—å‡¦ç†ã¨èåˆ
- ã“ã‚Œã«ã‚ˆã‚Šã€Œç©ºé–“çš„æ³¨æ„ã€ã‚’ SSM ã§ä»£æ›¿ã—ã¦ã„ã‚‹

**ç†è«–çš„æ„ç¾©:**
- Transformer ã® Self-Attention ã¯ O(nÂ²) ã®è¨ˆç®—ã‚³ã‚¹ãƒˆ
- Mamba ã® SSM ã¯ O(n) ã§åŒç­‰ã®ã€Œé•·è·é›¢ä¾å­˜ã€ã‚’å­¦ç¿’å¯èƒ½
- Tesseract Field ã¯ç©ºé–“æ¬¡å…ƒã®ã€Œåœ§ç¸®è¡¨ç¾ã€ã‚’ SSM ã«æ¸¡ã™å½¹å‰²

---

## 4. å­¦ç¿’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

### 4.1 Policy + Value åŒæ™‚å­¦ç¿’
```python
Total Loss = Policy Loss + Î± Ã— Value Loss
```

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å€¤ |
|------------|-----|
| Î± (VALUE_LOSS_WEIGHT) | 0.5 |
| å­¦ç¿’ç‡ | 1e-4 |
| ãƒãƒƒãƒã‚µã‚¤ã‚º | 32 |
| æœ€å¤§æ‰‹æ•°/ã‚²ãƒ¼ãƒ  | 150 |

### 4.2 åœ°è¨ˆç®—ï¼ˆchain_utils.pyï¼‰

GPU-native ãªåœ°è¨ˆç®—ã‚’ `chain_utils.py` ã«å®Ÿè£…ã€‚

**ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ : Conv2d Flood-Fill**
```python
def compute_territory(boards, komi=6.5):
    """
    Tromp-Taylor Area Scoring
    
    1. é»’çŸ³ãƒ»ç™½çŸ³ã®ä½ç½®ã‚’å–å¾—
    2. Conv2d ã§éš£æ¥ä¼æ’­ï¼ˆflood-fillï¼‰
    3. é»’ã®ã¿ã«éš£æ¥ã™ã‚‹ç©ºç‚¹ = é»’ã®åœ°
    4. ç™½ã®ã¿ã«éš£æ¥ã™ã‚‹ç©ºç‚¹ = ç™½ã®åœ°
    5. ã‚¹ã‚³ã‚¢ = çŸ³ + åœ°
    """
```

**ç‰¹å¾´:**
- Python ãƒ«ãƒ¼ãƒ—ãªã—
- ãƒãƒƒãƒå‡¦ç†å¯¾å¿œ
- çµ‚å±€æ™‚ã« 1 å›å‘¼ã¶ã ã‘

### 4.3 å­¦ç¿’çµæœï¼ˆPhase III.2ï¼‰

#### æˆåŠŸç‰ˆï¼ˆâš ï¸ å½æˆåŠŸã®ç–‘ã„ï¼‰

| æŒ‡æ¨™ | é–‹å§‹ | çµ‚äº† | å¤‰åŒ– |
|------|------|------|------|
| Policy Loss | 5.94 | 3.58 | -40% |
| Value Loss | 0.32 | 0.06 | -81% |
| é€Ÿåº¦ | 9.3 g/s | 15.6 g/s | +68% |
| ç·ã‚²ãƒ¼ãƒ æ•° | 0 | 10,000 | - |
| Win Rate vs Random | - | **0%** | âš ï¸ |

> âš ï¸ **å•é¡Œ**: Loss ã¯æ”¹å–„ã—ãŸãŒ Win Rate 0%ã€‚ãƒ‘ã‚¹é€£æ‰“ã§ã‚²ãƒ¼ãƒ ãŒå³çµ‚äº†ã—ã€å®Ÿéš›ã«ã¯ç›¤é¢ã‚’å­¦ç¿’ã—ã¦ã„ãªã„ç–‘ã„ã€‚

#### Fixedç‰ˆï¼ˆé€²è¡Œä¸­ï¼‰

| æŒ‡æ¨™ | å€¤ | å‚™è€ƒ |
|------|-----|------|
| Policy Loss | 5.91 | ç›¸è»¢ç§»å‰ |
| ãƒ‘ã‚¹åˆ¶é™ | 50æ‰‹ã¾ã§ç¦æ­¢ | ãƒ‘ã‚¹é€£æ‰“å¯¾ç­– |
| ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚° | 8ç‚¹/ã‚²ãƒ¼ãƒ  | å­¦ç¿’åŠ¹ç‡å‘ä¸Š |

**ç‰¹ç­†ã™ã¹ãç¾è±¡:**
- æˆåŠŸç‰ˆã®6,000ã‚²ãƒ¼ãƒ ç›®ã§ã€Œç›¸è»¢ç§»ã€ã‚‰ã—ãç¾è±¡ãŒç™ºç”Ÿ
- ã—ã‹ã—ã€ã“ã‚Œã¯ã€Œãƒ‘ã‚¹é€£æ‰“ã‚’å­¦ç¿’ã—ãŸã€å½ã®ç›¸è»¢ç§»ã ã£ãŸå¯èƒ½æ€§
- Fixedç‰ˆã§çœŸã®ç›¸è»¢ç§»ã‚’ç›®æŒ‡ã™

### 4.4 è¦–ç‚¹ã®æ•´åˆæ€§ï¼ˆDEC-008/009ï¼‰

Phase III.2 ã§ Win Rate 0% ãŒç¶™ç¶šã—ãŸåŸå› ã¨ã—ã¦ã€è¦–ç‚¹ã®ä¸æ•´åˆãŒç™ºè¦‹ã•ã‚ŒãŸã€‚

#### DEC-008: è¦–ç‚¹æ­£è¦åŒ–ï¼ˆPerspective Normalizationï¼‰

**å•é¡Œ:** ç›¤é¢ã‚’å¸¸ã«ã€Œé»’=+1, ç™½=-1ã€ã®çµ¶å¯¾åº§æ¨™ã§ãƒ¢ãƒ‡ãƒ«ã«æ¸¡ã—ã¦ã„ãŸã€‚
ç™½ç•ªæ™‚ã€ãƒ¢ãƒ‡ãƒ«ã¯ã€Œè‡ªåˆ†ã®çŸ³ãŒ -1ã€ã¨ã„ã†çŸ›ç›¾ã—ãŸçŠ¶æ…‹ã§å­¦ç¿’ã€‚

**è§£æ±º:**
```python
perspective = 1.0 if idx % 2 == 0 else -1.0
current_board = current_board * perspective
```

ã“ã‚Œã«ã‚ˆã‚Šå¸¸ã«ã€Œè‡ªåˆ†=+1, ç›¸æ‰‹=-1ã€ã§ãƒ¢ãƒ‡ãƒ«ã«æ¸¡ã•ã‚Œã‚‹ã€‚

#### DEC-009: Turn Embedding

**å•é¡Œ:** DEC-008 é©ç”¨å¾Œã‚‚ Win Rate 0% ãŒç¶™ç¶šã€‚
ç›¤é¢ã¯ä¸»è¦³åŒ–ã•ã‚ŒãŸãŒã€æ‰‹é †ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ï¼ˆseqï¼‰ã¯å®¢è¦³çš„ãªåº§æ¨™IDã®ã¾ã¾ã ã£ãŸã€‚
Mamba ã¯ã€Œèª°ã®æ‰‹ã‹ã€ã‚’è­˜åˆ¥ã§ããªã„çŠ¶æ…‹ã€‚

**è§£æ±º:** Turn Embedding ã‚’å°å…¥ã€‚
```python
# MambaModel.__init__ å†…
self.turn_emb = nn.Embedding(2, d_model)  # 0=Self, 1=Other

# MambaModel.forward å†…
h = self.embedding(seq)
h = h + self.turn_emb(turn_seq)  # ä¸»è¦³ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ä»˜ä¸
```

**turn_seq ã®ç”Ÿæˆãƒ«ãƒ¼ãƒ«:**
- ç¾åœ¨ã®æ‰‹ç•ªã‹ã‚‰è¦‹ã¦ã€å„ãƒˆãƒ¼ã‚¯ãƒ³ãŒã€Œè‡ªåˆ†(0)ã‹ç›¸æ‰‹(1)ã‹ã€ã‚’åˆ¤å®š
- ä¾‹: é»’ç•ªè¦–ç‚¹ã§ [é»’ã®æ‰‹, ç™½ã®æ‰‹, é»’ã®æ‰‹] â†’ turn_seq = [0, 1, 0]

**è¨­è¨ˆæ€æƒ³ã¨ã®æ•´åˆ:**
- vocab_size=363 ã‚’ç¶­æŒï¼ˆDEC-002 éµå®ˆï¼‰
- Information Continuity ã‚’ç¶­æŒï¼ˆåŒä¸€åº§æ¨™=åŒä¸€IDï¼‰
- æœ€å°å¤‰æ›´ã§æœ€å¤§åŠ¹æœ


---

## 5. è©•ä¾¡ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

### 5.1 Internal Score Consistencyï¼ˆå†…çœã®æ•´åˆæ€§ï¼‰

ãƒ¢ãƒ‡ãƒ«ã® Value Head ãŒäºˆæ¸¬ã—ãŸå€¤ `v` ã¨ã€å®Ÿéš›ã®çµ‚å±€å‹æ•— `y` ã®ä¸€è‡´åº¦ã‚’æ¸¬å®šã€‚
```
Accuracy_value = P(sign(v) == y)
```

**æ„ç¾©:**
- å˜ãªã‚‹å‹ç‡ã§ã¯ãªãã€ã€Œãƒ¢ãƒ‡ãƒ«ãŒè‡ªåˆ†ã®å½¢å‹¢åˆ¤æ–­ã‚’ã©ã‚Œã ã‘ä¿¡ã˜ã€ãã‚ŒãŒäº‹å®Ÿã«å³ã—ã¦ã„ã‚‹ã‹ã€ã‚’æ¸¬ã‚‹
- ã“ã‚ŒãŒé«˜ã„ã»ã©ã€ãƒ¢ãƒ‡ãƒ«ã¯ã€Œè‡ªåˆ†ãŒãªãœãã®æ‰‹ã‚’æ‰“ã£ãŸã‹ï¼ˆå‹ã¤ãŸã‚ï¼‰ã€ã‚’è‡ªè¦šã—ã¦ã„ã‚‹

### 5.2 Value Head Calibration

Value Head ã®å‡ºåŠ›ãŒç¢ºç‡çš„ã«æ­£ã—ã„ã‹ã‚’æ¸¬å®šã€‚

| æŒ‡æ¨™ | èª¬æ˜ |
|------|------|
| **Expected Calibration Error (ECE)** | äºˆæ¸¬ç¢ºç‡ã¨å®Ÿéš›ã®å‹ç‡ã®ä¹–é›¢ |
| **Brier Score** | ç¢ºç‡äºˆæ¸¬ã®ç²¾åº¦ |

### 5.3 è©•ä¾¡å¯¾è±¡

| å¯¾æˆ¦ | ç›®çš„ | æœŸå¾…ã•ã‚Œã‚‹çµæœ |
|------|------|----------------|
| **Phase III.2 vs Random** | åŸºç¤æ€§èƒ½ç¢ºèª | å‹ç‡ > 0%ï¼ˆæœ€ä½æ¡ä»¶ï¼‰ |
| **Phase III.2 vs Phase II** | ä¸–ä»£é–“æ¯”è¼ƒ | Phase III.2 å„ªä½ |

### 5.4 å¤–éƒ¨è©•ä¾¡ï¼ˆGTPï¼‰

**çŠ¶æ…‹:** æœªå®Ÿè£…

**è¨ˆç”»:**
- GnuGo / KataGo ã¨ã®å¯¾æˆ¦
- GTP (Go Text Protocol) ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®Ÿè£…
- å¤–éƒ¨ ELO ã¨ã®å¯¾å¿œä»˜ã‘

**æ³¨æ„:** å¤–éƒ¨ã‚¨ãƒ³ã‚¸ãƒ³ã¯è©•ä¾¡å°‚ç”¨ã€‚å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã«ã¯ä½¿ç”¨ã—ãªã„ï¼ˆClean Room åŸå‰‡ï¼‰ã€‚

---

## 6. å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### Phase III.1: TesseraModel çµ±åˆ âœ… å®Œäº†

| æˆæœç‰© | çŠ¶æ…‹ |
|--------|------|
| `tessera_model.py` | å®Ÿè£…æ¸ˆã¿ |
| Mamba + Tesseract Field çµ±åˆ | å®Œäº† |
| å­¦ç¿’ãƒ«ãƒ¼ãƒ—ã¨ã®æ¥ç¶š | å®Œäº† |

### Phase III.2: Tromp-Taylor + Value Head ğŸ”„ é€²è¡Œä¸­ï¼ˆãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰

| æˆæœç‰© | çŠ¶æ…‹ |
|--------|------|
| `chain_utils.py` | âœ… å®Ÿè£…æ¸ˆã¿ |
| `gpu_go_engine.py` (Tromp-Taylor ç‰ˆ) | âœ… å®Ÿè£…æ¸ˆã¿ |
| `train_phase3_2.py` | âš ï¸ æˆåŠŸç‰ˆï¼ˆå½æˆåŠŸã®ç–‘ã„ï¼‰ |
| `train_phase3_2_fixed.py` | ğŸ”„ Fixedç‰ˆï¼ˆé€²è¡Œä¸­ï¼‰ |
| ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆï¼ˆæˆåŠŸç‰ˆï¼‰ | âš ï¸ å½æˆåŠŸã®ç–‘ã„ |
| ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆï¼ˆFixedç‰ˆï¼‰ | ğŸ”„ ç›¸è»¢ç§»å‰ |

**å®Œäº†æ¡ä»¶ï¼ˆå†å®šç¾©ï¼‰:**

| # | æ¡ä»¶ | ç¾çŠ¶ |
|---|------|------|
| 1 | Fixedç‰ˆã§ç›¸è»¢ç§»ï¼ˆLossæ€¥é™ä¸‹ï¼‰ | âŒ æœªé” |
| 2 | Win Rate vs Random > 0% | âŒ æœªé” |
| 3 | ãƒ‘ã‚¹é€£æ‰“ã§ãªã„æ­£å¸¸ãªå¯¾å±€ | ğŸ”„ ç¢ºèªä¸­ |

### Phase III.3: è©•ä¾¡ã¨æ¤œè¨¼ â³ Phase III.2å®Œäº†å¾Œ

| Step | å†…å®¹ | çŠ¶æ…‹ |
|------|------|------|
| 1 | vs Random (100 æˆ¦) | å¾…æ©Ÿä¸­ |
| 2 | vs Phase II | å¾…æ©Ÿä¸­ |
| 3 | Internal Score Consistency æ¸¬å®š | å¾…æ©Ÿä¸­ |
| 4 | SGF Exporter | å¾…æ©Ÿä¸­ |

### Phase III.4: å¤–éƒ¨è©•ä¾¡ â³ å°†æ¥

| Step | å†…å®¹ | çŠ¶æ…‹ |
|------|------|------|
| 5 | GTP ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ | æœªå®Ÿè£… |
| 6 | GnuGo å¯¾æˆ¦ | æœªå®Ÿè£… |
| 7 | ELO æ ¡æ­£ | æœªå®Ÿè£… |

---

## 7. ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
```
src/
â”œâ”€â”€ gpu_go_engine.py      # Tromp-Taylor ç‰ˆã‚¨ãƒ³ã‚¸ãƒ³
â”œâ”€â”€ tessera_model.py      # TesseraModel (Mamba + Tesseract + Value)
â”œâ”€â”€ chain_utils.py        # GPU åœ°è¨ˆç®—
â”œâ”€â”€ train_phase3_2.py     # Phase III.2 å­¦ç¿’ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆæˆåŠŸç‰ˆã€âš ï¸å½æˆåŠŸã®ç–‘ã„ï¼‰
â”œâ”€â”€ train_phase3_2_fixed.py # Phase III.2 Fixedç‰ˆå­¦ç¿’ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ eval_quick.py         # Win Rateç°¡æ˜“è©•ä¾¡
â”œâ”€â”€ long_training_v5.py   # Phase II å­¦ç¿’ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆå‚è€ƒï¼‰
â””â”€â”€ monitor.py            # TesseraMonitor

checkpoints/
â”œâ”€â”€ tessera_phase3.2_final_loss3.58.pth      # âš ï¸ å½æˆåŠŸã®ç–‘ã„
â”œâ”€â”€ tessera_phase3.2_fixed_final_loss5.91.pth # ğŸ”„ Fixedç‰ˆã€ç›¸è»¢ç§»å‰
â”œâ”€â”€ tessera_phase3.2_game4000.pth
â””â”€â”€ tessera_phase3.2_game6000.pth
```

---

## ä»˜éŒ² A: æŠ€è¡“çš„ãƒªã‚¹ã‚¯ã¨å¯¾ç­–

| ãƒªã‚¹ã‚¯ | å¯¾ç­– | çŠ¶æ…‹ |
|--------|------|------|
| é€£ã®æ¤œå‡ºãŒè¤‡é›‘ | Tromp-Taylor ã§å›é¿ | âœ… è§£æ±º |
| çµ‚å±€åˆ¤å®šãŒæ›–æ˜§ | Area Scoring ã§ä¸€æ„åŒ– | âœ… è§£æ±º |
| Value Head ãŒåæŸã—ãªã„ | å‹æ•—ä¿¡å·ã®æ˜ç¢ºåŒ– | ğŸ”„ æ¤œè¨¼ä¸­ |
| **ãƒ‘ã‚¹é€£æ‰“ã«ã‚ˆã‚‹å½æˆåŠŸ** | **ãƒ‘ã‚¹åˆ¶é™ã€8ç‚¹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°** | ğŸ”„ å¯¾å‡¦ä¸­ |
| å¤–éƒ¨è©•ä¾¡ã¨ã®ä¹–é›¢ | GTP å®Ÿè£…äºˆå®š | â³ å°†æ¥ |

---

## ä»˜éŒ² B: ç”¨èªé›†

| ç”¨èª | èª¬æ˜ |
|------|------|
| **Tromp-Taylor** | æ•ç²ãªã—ãƒ»Area Scoring ã®å›²ç¢ãƒ«ãƒ¼ãƒ«å¤‰ç¨® |
| **Information Continuity** | çŸ³ãŒæ¶ˆãˆãªã„ã“ã¨ã«ã‚ˆã‚‹ SSM State ã®é€£ç¶šæ€§ |
| **Internal Score Consistency** | Value äºˆæ¸¬ã¨å®Ÿéš›ã®å‹æ•—ã®ä¸€è‡´åº¦ |
| **Tesseract Field** | ç›¤é¢ç©ºé–“ç‰¹å¾´ã‚’æŠ½å‡ºã™ã‚‹ Conv2d ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« |
| **GPU Sovereignty** | å…¨è¨ˆç®—ã‚’ GPU å†…ã§å®Œçµã•ã›ã‚‹è¨­è¨ˆåŸå‰‡ |
| **å½æˆåŠŸ** | Loss ã¯æ”¹å–„ã—ãŸãŒå®Ÿéš›ã®æ€§èƒ½ï¼ˆWin Rateï¼‰ãŒä¼´ã‚ãªã„çŠ¶æ…‹ |

---

## ä»˜éŒ² C: ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆæƒ…å ±

| ãƒ•ã‚¡ã‚¤ãƒ« | å†…å®¹ | Loss | çŠ¶æ…‹ |
|----------|------|------|------|
| `tessera_phase3.2_final_loss3.58.pth` | æˆåŠŸç‰ˆæœ€çµ‚ | 3.58 | âš ï¸ å½æˆåŠŸã®ç–‘ã„ |
| `tessera_phase3.2_fixed_final_loss5.91.pth` | Fixedç‰ˆæœ€çµ‚ | 5.91 | ğŸ”„ æ­£ã—ã„æ–¹å‘ã€ç›¸è»¢ç§»å‰ |
| `tessera_phase3.2_game4000.pth` | ä¸­é–“ (4000 games) | ~5.9 | å‚è€ƒ |
| `tessera_phase3.2_game6000.pth` | ç›¸è»¢ç§»ç›´å¾Œ | ~5.8 | âš ï¸ å½ã®ç›¸è»¢ç§»ã®å¯èƒ½æ€§ |

---

*"Le symbole donne Ã  penser."* â€” Paul RicÅ“ur

â€” End of Document â€”
