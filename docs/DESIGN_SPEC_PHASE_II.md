# Tessera (MambaGo) Phase II è¨­è¨ˆä»•æ§˜æ›¸

**Version:** 0.2.2 (Final)  
**Date:** 2026-01-12  
**Status:** è¨­è¨ˆå®Œäº†ã€å®Ÿè£…å¾…ã¡  
**Author:** beachcities + Claude

---

## 0. Phase II å®Œäº†æ¡ä»¶

> **ã“ã®ä»•æ§˜æ›¸ã®ã‚¹ã‚³ãƒ¼ãƒ—ã‚’æ˜ç¢ºã«ã™ã‚‹**

Phase II ã¯ä»¥ä¸‹ã®æ¡ä»¶ã‚’**å…¨ã¦**æº€ãŸã—ãŸã¨ãã«å®Œäº†ã¨ã™ã‚‹ï¼š

| # | æ¡ä»¶ | æ¤œè¨¼æ–¹æ³• | å®šé‡åŸºæº– |
|---|------|----------|----------|
| 1 | GPUGoEngine ãŒå®‰å®šå‹•ä½œ | ãƒ©ãƒ³ãƒ€ãƒ å¯¾å±€ãƒ†ã‚¹ãƒˆ | 10ãƒãƒƒãƒä¸­9ãƒãƒƒãƒãŒ100å±€å®Œèµ° |
| 2 | MambaModel ã®å­¦ç¿’ãŒé€²è¡Œ | Loss æ¨ç§»ã®ç¢ºèª | 1000stepä»¥å†…ã«åˆæœŸå€¤ã‹ã‚‰10%ä»¥ä¸Šæ¸›å°‘ |
| 3 | GPUå†…å®Œçµã®ç¶­æŒ | `time_transfer` ç›£è¦– | å¹³å‡ < 0.5msã€æœ€å¤§ < 1.0ms |
| 4 | TesseraMonitor ãŒæ©Ÿèƒ½ | ã‚µãƒãƒªãƒ¼å‡ºåŠ›ç¢ºèª | Top5ãƒ¡ãƒˆãƒªã‚¯ã‚¹å…¨ã¦å–å¾—å¯èƒ½ |
| 5 | ä¸­ç›¤ä»¥é™ã‚‚å®‰å®š | é•·æœŸå¯¾å±€ãƒ†ã‚¹ãƒˆ | 10ãƒãƒƒãƒä¸­8ãƒãƒƒãƒãŒ300æ‰‹å®Œèµ° |

**Phase II ã«å«ã¾ãªã„ã‚‚ã®ï¼ˆPhase III ä»¥é™ï¼‰ï¼š**
- Incremental Inferenceï¼ˆ1æ‰‹ãšã¤ã®çŠ¶æ…‹æ›´æ–°ï¼‰
- Landmark Memoryï¼ˆé‡è¦ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚¹ãƒ‘ãƒ¼ã‚¹ä¿æŒï¼‰
- ä¿‚äº‰åœ°ãƒã‚¹ã‚­ãƒ³ã‚°
- é€£ã®GPUå®Œå…¨å®Ÿè£…ï¼ˆConnected Componentsï¼‰
- ç›¤é¢ç‰¹å¾´é‡ã®è¿½åŠ 

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### 1.1 åŸºæœ¬æƒ…å ±

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå | Tessera (MambaGo) |
| ãƒªãƒã‚¸ãƒˆãƒª | beachcities/Tessera |
| ç›®çš„ | Post-Transformeræ™‚ä»£ã®GPU Nativeå›²ç¢AIã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ |
| ã‚³ã‚¢æŠ€è¡“ | Mamba (State Space Model) ã«ã‚ˆã‚‹æ‰‹é †ã‚·ãƒ¼ã‚±ãƒ³ã‚¹äºˆæ¸¬ |

### 1.2 æ€æƒ³çš„èƒŒæ™¯ (The Mythos)

> *è©³ç´°ã¯ README.md ã‚’å‚ç…§ã€‚ã“ã“ã§ã¯æŠ€è¡“ã¨ã®æ¥ç‚¹ã®ã¿è¨˜ã™ã€‚*

MambaGoã¯ã€Œç¢ºç‡çš„ãªçŸ¥ã€ã¨ã€Œé¸æŠã®è‡ªç”±ï¼ˆAgencyï¼‰ã€ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æä¾›ã™ã‚‹ã€‚
å‡ºåŠ›ã¯å˜ä¸€ã®æœ€å–„æ‰‹ã§ã¯ãªãã€**ç¢ºç‡åˆ†å¸ƒ**â€”â€”è¤‡æ•°ã®å¯èƒ½æ€§ã®åœ°å›³ã€‚
æœ€å¾Œã®ä¸€æ‰‹ã¯å¸¸ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸ã¶ã€‚

---

## 2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å…¨ä½“åƒ

### 2.1 GPU Native è¨­è¨ˆåŸå‰‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     GPU å†…å®Œçµã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£                  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                 TesseraMonitor                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚              GPUGoEngine                          â”‚     â”‚
â”‚  â”‚        Batched Board State (batch, 3, 19, 19)     â”‚     â”‚
â”‚  â”‚        Vectorized Operations (ãƒ«ãƒ¼ãƒ—ãªã—)          â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                            â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                 MambaModel                        â”‚     â”‚
â”‚  â”‚     Embedding â†’ Mamba (SSM) â†’ Head               â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚                    CPU-GPUè»¢é€: ã‚¼ãƒ­                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è¨­è¨ˆåŸå‰‡

| åŸå‰‡ | èª¬æ˜ |
|------|------|
| GPU Complete | å…¨æ“ä½œãŒGPUå†…ã§å®Œçµã€CPUè»¢é€ã‚¼ãƒ­ |
| Batch First | å…¨æ“ä½œãŒãƒãƒƒãƒåŒ–ã•ã‚ŒãŸãƒ†ãƒ³ã‚½ãƒ«æ¼”ç®— |
| No Python Loop | ãƒ«ãƒ¼ãƒ—ã¯torchæ¼”ç®—ã«ç½®æ› |
| Observable | å…¨ã¦ã®æŒ™å‹•ãŒãƒ¢ãƒ‹ã‚¿ãƒ¼å¯èƒ½ |

---

## 3. ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ

### 3.1 ãƒˆãƒ¼ã‚¯ãƒ³å®šç¾©

```python
VOCAB_SIZE = 364
BOARD_SIZE = 19

# 0-360: ç›¤ä¸Šåº§æ¨™ (row * 19 + col)
# 361:   PASS
# 362:   PAD
# 363:   EOS

PASS_TOKEN = 361
PAD_TOKEN = 362
EOS_TOKEN = 363
```

### 3.2 å…¥åŠ›å½¢å¼

**Phase II ã§ã¯æ‰‹é †åˆ—ã®ã¿ã‚’ä½¿ç”¨ã™ã‚‹ã€‚**

```python
input_sequence  = [34, 120, 15, 203, 88, ...]  # å„æ‰‹ã®åº§æ¨™ãƒˆãƒ¼ã‚¯ãƒ³
target_sequence = [120, 15, 203, 88, 45, ...]  # 1ã¤ãšã‚ŒãŸæ¬¡ã®æ‰‹
```

> **å°†æ¥æ‹¡å¼µï¼ˆPhase IIIä»¥é™ï¼‰ï¼š**
> æ‰‹é †åˆ—ã«åŠ ãˆã¦è»½é‡ãªç›¤é¢ç‰¹å¾´é‡ï¼ˆçŸ³æ•°å·®ã€ã‚³ã‚¦å±¥æ­´ã€åœ°åˆã„å‚¾å‘ï¼‰ã‚’è¿½åŠ ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

### 3.3 ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹

| Phase | ã‚½ãƒ¼ã‚¹ | ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ |
|-------|--------|-----------|
| II-a | åˆæˆãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ©ãƒ³ãƒ€ãƒ å¯¾å±€ï¼‰ | **å®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³** |
| II-b | Mambaè‡ªå·±å¯¾å±€ | **å®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³** |

**å¤–éƒ¨SGFã¯ä½¿ç”¨ã—ãªã„ã€‚**

---

## 4. GPUGoEngine è¨­è¨ˆ

### 4.1 Phase II ã®å®Ÿè£…ç¯„å›²

| æ©Ÿèƒ½ | Phase II | Phase III+ |
|------|----------|------------|
| ç©ºç‚¹åˆ¤å®š | âœ… | - |
| ç€æ‰‹å®Ÿè¡Œ | âœ… | - |
| å˜çŸ³ã®æ•ç²ï¼ˆå‘¼å¸ç‚¹ã‚¼ãƒ­ï¼‰ | âœ… ç°¡æ˜“ç‰ˆ | é€£ã®å®Œå…¨å®Ÿè£… |
| ã‚³ã‚¦åˆ¤å®š | âœ… å˜ç´”ç‰ˆ | ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚³ã‚¦ |
| è‡ªæ®ºæ‰‹åˆ¤å®š | âœ… å˜çŸ³ã®ã¿ | é€£ã‚’å«ã‚€å®Œå…¨ç‰ˆ |
| çµ‚å±€åˆ¤å®š | âœ… äºŒé€£ç¶šãƒ‘ã‚¹ | åœ°ã®è¨ˆç®— |

> **Phase II ç°¡æ˜“ç‰ˆæ•ç²ã®åˆ¶é™ï¼š**
> å˜çŸ³ã®ã¿ã®æ•ç²ã®ãŸã‚ã€2å­ä»¥ä¸Šã®é€£ãŒå–ã‚‰ã‚Œã‚‹å±€é¢ã§ã¯æ­£ã—ã„æŒ™å‹•ã«ãªã‚‰ãªã„ã€‚
> ãŸã ã— Phase II ã®ç›®çš„ï¼ˆè‡ªå·±å¯¾å±€ã®å®‰å®šå‹•ä½œï¼‰ã«ã¯å½±éŸ¿ã—ãªã„ã€‚
> é€£ã®å®Œå…¨å®Ÿè£…ã¯ Phase III ã§å¯¾å¿œã™ã‚‹ã€‚

### 4.2 ã‚¯ãƒ©ã‚¹æ§‹é€ 

```python
class GPUGoEngine:
    def __init__(self, batch_size: int, device: str = 'cuda'):
        # ç›¤é¢çŠ¶æ…‹ (batch, 3, 19, 19)
        self.boards: torch.Tensor
        # æ‰‹ç•ª (batch,) - 0=é»’, 1=ç™½
        self.turn: torch.Tensor
        # æ‰‹é †å±¥æ­´ (batch, max_seq_len)
        self.history: torch.Tensor
```

### 4.3 ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰

| ãƒ¡ã‚½ãƒƒãƒ‰ | å‡ºåŠ› | Phase II å®Ÿè£… |
|----------|------|---------------|
| `get_legal_mask()` | `(batch, 362)` | ç©ºç‚¹ + å˜ç´”ã‚³ã‚¦ |
| `play_batch(moves)` | - | çŸ³ã‚’ç½®ã |
| `capture_stones()` | - | **å˜çŸ³ã®ã¿** |
| `is_game_over()` | `(batch,)` | äºŒé€£ç¶šãƒ‘ã‚¹ |

---

## 5. MambaModel è¨­è¨ˆ

### 5.1 ãƒ¢ãƒ‡ãƒ«æ§‹é€ 

```python
class MambaModel(nn.Module):
    def __init__(self, vocab_size=364, d_model=256, d_state=16, d_conv=4, expand=2):
        self.embedding = nn.Embedding(vocab_size, d_model)
        self.mamba = Mamba(d_model, d_state, d_conv, expand)
        self.head = nn.Linear(d_model, vocab_size)
```

### 5.2 SSM State ã®å–å¾—æ–¹æ³•

> **mamba-ssm ã®å†…éƒ¨çŠ¶æ…‹ã¯ç›´æ¥å–å¾—ã§ããªã„ãŸã‚ã€forward hook ã‚’ä½¿ç”¨ã™ã‚‹ã€‚**

```python
class MambaStateCapture:
    """
    MambaBlock.forward ã« hook ã‚’æŒ¿å…¥ã—ã€SSM State ã‚’å–å¾—ã™ã‚‹
    """
    def __init__(self, model: MambaModel):
        self.captured_state = None
        
        def hook_fn(module, input, output):
            if hasattr(module, 'last_state'):
                self.captured_state = module.last_state.detach().clone()
        
        model.mamba.register_forward_hook(hook_fn)
    
    def get_state(self) -> torch.Tensor:
        return self.captured_state
```

**èª¿æŸ»å¯¾è±¡ï¼ˆå®Ÿè£…æ™‚ã«ç¢ºèªï¼‰ï¼š**
- `mamba_ssm.modules.mamba_simple.Mamba.forward` ã®æˆ»ã‚Šå€¤
- `A, B, C, D` è¡Œåˆ—ã®æ›´æ–°ç®‡æ‰€
- `selective_scan` å†…éƒ¨ã® state ä¿æŒæ–¹æ³•
- mamba-ssm ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¾å­˜æ€§

---

## 6. TesseraMonitor è¨­è¨ˆ

### 6.1 æœ€é‡è¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹ Top 5

> **ã¾ãšã“ã®5ã¤ã‚’ç›£è¦–ã™ã‚‹ã€‚ä»–ã¯å¾Œã‹ã‚‰è¿½åŠ ã€‚**

| å„ªå…ˆåº¦ | ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | æ„å‘³ | è­¦å‘Šé–¾å€¤ |
|--------|-----------|------|----------|
| ğŸ¥‡ 1 | `time_transfer` | CPU-GPUè»¢é€æ™‚é–“ | > 1.0ms |
| ğŸ¥ˆ 2 | `vram_used_mb` | VRAMä½¿ç”¨é‡ | > 85% |
| ğŸ¥‰ 3 | `fragmentation_ratio` | ãƒ¡ãƒ¢ãƒªæ–­ç‰‡åŒ– | > 1.5x |
| 4 | `ssm_state_norm` | SSMçŠ¶æ…‹ã®ç™ºæ•£ | > 100.0 |
| 5 | `move_number` + `legal_moves_count` | ã‚²ãƒ¼ãƒ é€²è¡Œã®å¥å…¨æ€§ | - |

### 6.2 æ¨å¥¨ãƒ­ã‚°é »åº¦

| ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | é »åº¦ | ç†ç”± |
|-----------|------|------|
| `time_forward`, `time_legal_mask`, `time_transfer` | æ¯æ‰‹ | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ–ã®å³æ™‚æ¤œçŸ¥ |
| `ssm_state_norm`, `ssm_state_delta_norm` | 10æ‰‹ã”ã¨ | çŠ¶æ…‹å¤‰åŒ–ã®ãƒˆãƒ¬ãƒ³ãƒ‰æŠŠæ¡ |
| `fragmentation_ratio`, `vram_used_mb` | 50æ‰‹ã”ã¨ | ãƒ¡ãƒ¢ãƒªæ¨ç§»ã®é•·æœŸç›£è¦– |
| å…¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹è©³ç´°ã‚µãƒãƒªãƒ¼ | 100æ‰‹ã”ã¨ | å®šæœŸãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ |

### 6.3 å…¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹ä¸€è¦§

| ã‚«ãƒ†ã‚´ãƒª | ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | èª¬æ˜ |
|----------|-----------|------|
| **Memory** | `vram_used_mb`, `vram_reserved_mb` | GPU ãƒ¡ãƒ¢ãƒª |
| **Fragmentation** | `fragmentation_ratio`, `num_segments` | æ–­ç‰‡åŒ– |
| **Mamba State** | `ssm_state_norm`, `ssm_state_entropy`, `ssm_state_delta_norm` | SSM çŠ¶æ…‹ |
| **Timing** | `time_forward`, `time_legal_mask`, `time_play_move`, `time_transfer` | å‡¦ç†æ™‚é–“ |
| **Game** | `move_number`, `stones_on_board`, `legal_moves_count` | å¯¾å±€çŠ¶æ…‹ |

### 6.4 ã‚¢ãƒ©ãƒ¼ãƒˆæ¡ä»¶

| æ¡ä»¶ | é–¾å€¤ | é‡è¦åº¦ |
|------|------|--------|
| CPU-GPU Transfer | > 1.0ms | ğŸ”´ **è¨­è¨ˆé•å** |
| VRAMä½¿ç”¨ç‡ | > 85% | ğŸ”´ High |
| Fragmentation | > 1.5x | ğŸŸ¡ Medium |
| SSM State Norm | > 100.0 | ğŸ”´ High |

---

## 7. ãƒ¡ãƒ¢ãƒªç®¡ç†è¨­è¨ˆ

### 7.1 Phase II ã®å¯¾ç­–

| å¯¾ç­– | Phase II | Phase III+ |
|------|----------|------------|
| ã‚¹ãƒ©ã‚¤ãƒ‡ã‚£ãƒ³ã‚°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ (64æ‰‹) | âœ… | - |
| å®šæœŸçš„ãƒ‡ãƒ•ãƒ©ã‚° (100æ‰‹ã”ã¨) | âœ… | - |
| Incremental Inference | âŒ | âœ… |
| Landmark Memory | âŒ | âœ… |

### 7.2 ã‚¹ãƒ©ã‚¤ãƒ‡ã‚£ãƒ³ã‚°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦

```python
MAX_CONTEXT = 64

def prepare_input(full_history):
    if len(full_history) > MAX_CONTEXT:
        return full_history[-MAX_CONTEXT:]
    return full_history
```

---

## 8. ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
GoMamba_Local/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ monitor.py          # TesseraMonitor
â”‚   â”œâ”€â”€ gpu_go_engine.py    # GPUGoEngine
â”‚   â”œâ”€â”€ model.py            # MambaModel
â”‚   â”œâ”€â”€ tokenizer.py        # ãƒˆãƒ¼ã‚¯ãƒ³å¤‰æ›
â”‚   â””â”€â”€ config.py           # å®šæ•°å®šç¾©
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_engine.py      # åˆæ³•æ‰‹åˆ¤å®šã€æ•ç²ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ test_model.py       # MambaModel å…¥å‡ºåŠ›å½¢çŠ¶
â”‚   â””â”€â”€ test_monitor.py     # ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ•´åˆæ€§
â”œâ”€â”€ configs/
â”‚   â”œâ”€â”€ config.yaml
â”‚   â””â”€â”€ model/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/
â”‚   â””â”€â”€ processed/
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ DESIGN_SPEC_PHASE_II.md   # æœ¬ä»•æ§˜æ›¸
â”œâ”€â”€ checkpoints/
â”œâ”€â”€ notebooks/
â”œâ”€â”€ main360_gpu_v4.py
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â””â”€â”€ README.md
```

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å½¹å‰²

| ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | å½¹å‰² |
|--------------|------|
| `src/` | æœ¬ä½“ã‚³ãƒ¼ãƒ‰ |
| `tests/` | è‡ªå‹•ãƒ†ã‚¹ãƒˆï¼ˆã‚¨ãƒ³ã‚¸ãƒ³ã€ãƒ¢ãƒ‡ãƒ«ã€ãƒ¢ãƒ‹ã‚¿ãƒ¼ï¼‰ |
| `docs/` | è¨­è¨ˆä»•æ§˜æ›¸ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã€å°†æ¥æ‹¡å¼µæ¡ˆ |
| `configs/` | Hydraè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« |
| `data/` | å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ï¼ˆåˆæˆãƒ‡ãƒ¼ã‚¿ï¼‰ |
| `checkpoints/` | ãƒ¢ãƒ‡ãƒ«ä¿å­˜å…ˆ |
| `notebooks/` | å®Ÿé¨“ãƒ»å¯è¦–åŒ– |

### tests/ ã®å†…å®¹

| ãƒ•ã‚¡ã‚¤ãƒ« | ãƒ†ã‚¹ãƒˆå†…å®¹ |
|----------|-----------|
| `test_engine.py` | åˆæ³•æ‰‹ãƒã‚¹ã‚¯ç”Ÿæˆã€ç€æ‰‹å®Ÿè¡Œã€å˜çŸ³æ•ç²ã€ã‚³ã‚¦åˆ¤å®š |
| `test_model.py` | MambaModel ã®å…¥å‡ºåŠ›å½¢çŠ¶ã€å‹¾é…ã®æµã‚Œ |
| `test_monitor.py` | ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—ã€ã‚¢ãƒ©ãƒ¼ãƒˆç™ºç«ã€ã‚µãƒãƒªãƒ¼å‡ºåŠ› |

---

## 9. å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

> **æ™‚é–“ã¯ç›®å®‰ã§ã‚ã‚Šã€å®Ÿè£…è€…ã®ç†Ÿç·´åº¦ã«ä¾å­˜ã™ã‚‹ã€‚**
> **LLMãŒå®Ÿè£…ã™ã‚‹å ´åˆã€å„ã‚¹ãƒ†ãƒƒãƒ—ã§å‹•ä½œç¢ºèªã‚’æŒŸã‚€ã“ã¨ã€‚**

### Phase II-a: åŸºç›¤æ§‹ç¯‰

| Step | å†…å®¹ | æˆæœç‰© | å®Œäº†æ¡ä»¶ |
|------|------|--------|----------|
| 1 | TesseraMonitor å®Ÿè£… | `src/monitor.py` | Top5ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—å¯èƒ½ |
| 2 | GPUGoEngine MVP | `src/gpu_go_engine.py` | åˆæ³•æ‰‹ãƒã‚¹ã‚¯ + ç€æ‰‹ |
| 3 | å˜çŸ³æ•ç²ã®å®Ÿè£… | åŒä¸Š | å‘¼å¸ç‚¹ã‚¼ãƒ­ã®çŸ³ãŒæ¶ˆãˆã‚‹ |
| 4 | ãƒ©ãƒ³ãƒ€ãƒ å¯¾å±€ãƒ†ã‚¹ãƒˆ | - | 10ãƒãƒƒãƒä¸­9ãƒãƒƒãƒãŒ100å±€å®Œèµ° |

### Phase II-b: å­¦ç¿’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

| Step | å†…å®¹ | æˆæœç‰© | å®Œäº†æ¡ä»¶ |
|------|------|--------|----------|
| 5 | MambaModel çµ±åˆ | `src/model.py` | forward ãŒé€šã‚‹ |
| 6 | SSM State ãƒ•ãƒƒã‚¯å®Ÿè£… | åŒä¸Š | çŠ¶æ…‹å–å¾—å¯èƒ½ |
| 7 | å­¦ç¿’ãƒ«ãƒ¼ãƒ—å®Ÿè£… | - | 1000stepä»¥å†…ã«Loss 10%æ¸›å°‘ |
| 8 | è‡ªå·±å¯¾å±€å®Œæˆ | - | **Phase II å®Œäº†** |

---

## 10. æŠ€è¡“çš„ãƒªã‚¹ã‚¯ã¨å¯¾ç­–

| ãƒªã‚¹ã‚¯ | å¯¾ç­– | Phase |
|--------|------|-------|
| ä¸­ç›¤ä»¥é™ã®OOM | ã‚¹ãƒ©ã‚¤ãƒ‡ã‚£ãƒ³ã‚°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ + ãƒ‡ãƒ•ãƒ©ã‚° | II |
| SSM State ç™ºæ•£ | Monitor ã§æ—©æœŸæ¤œçŸ¥ã€Gradient Clipping | II |
| é€£ã®æ¤œå‡ºãŒè¤‡é›‘ | **å˜çŸ³ã®ã¿å®Ÿè£…**ã€é€£ã¯ Phase III ã¸ | II |
| mamba-ssm çŠ¶æ…‹å–å¾— | forward hook ã§å¯¾å¿œ | II |

---

## 11. å°†æ¥æ‹¡å¼µï¼ˆPhase III ä»¥é™ï¼‰

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| Incremental Inference | 1æ‰‹ãšã¤çŠ¶æ…‹æ›´æ–°ã€å…¨å±¥æ­´å†è¨ˆç®—ã‚’å›é¿ |
| é€£ã®GPUå®Ÿè£… | Connected Components ã®ãƒãƒƒãƒå‡¦ç† |
| Landmark Memory | é‡è¦ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆã‚³ã‚¦ã€å¤§çŸ³æ­»ï¼‰ã®ã‚¹ãƒ‘ãƒ¼ã‚¹ä¿æŒ |
| ä¿‚äº‰åœ°ãƒã‚¹ã‚­ãƒ³ã‚° | ç¢ºå®šé ˜åŸŸã‚’è¨ˆç®—ã‹ã‚‰é™¤å¤– |
| ç›¤é¢ç‰¹å¾´é‡ | çŸ³æ•°å·®ã€ã‚³ã‚¦å±¥æ­´ã€åœ°åˆã„å‚¾å‘ |

---

## ä»˜éŒ² A: ç’°å¢ƒæƒ…å ±

| é …ç›® | å€¤ |
|------|-----|
| OS | WSL2 Ubuntu |
| GPU | NVIDIA GeForce RTX 4070 Laptop (8GB) |
| CUDA | 12.6 |
| PyTorch | 2.9.1+cu126 |
| mamba-ssm | >= 2.2.6 |
| Python | 3.10 |

---

## ä»˜éŒ² B: docker-compose.yml

```yaml
services:
  tessera:
    build: .
    runtime: nvidia
    shm_size: '8gb'
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
    volumes:
      - .:/app
    working_dir: /app
    stdin_open: true
    tty: true
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
```

---

*"Le symbole donne Ã  penser."*

â€” End of Document â€”
